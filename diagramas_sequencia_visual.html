<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagramas de Sequ√™ncia - Sistema Tutorando</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0 0 10px 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .nav-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            justify-content: center;
        }
        
        .nav-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,123,255,0.2);
        }
        
        .nav-btn:hover {
            background: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,123,255,0.3);
        }
        
        .nav-btn.active {
            background: #28a745;
            box-shadow: 0 4px 8px rgba(40,167,69,0.3);
        }
        
        .diagram-section {
            display: none;
            padding: 30px;
            background: white;
        }
        
        .diagram-section.active {
            display: block;
        }
        
        .diagram-title {
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 300;
        }
        
        .diagram-description {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #007bff;
        }
        
        .mermaid-container {
            background: #fafafa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        .info-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .info-box h4 {
            color: #856404;
            margin: 0 0 10px 0;
        }
        
        .info-box ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .emoji {
            font-size: 1.2em;
            margin-right: 8px;
        }
        
        @media (max-width: 768px) {
            .nav-buttons {
                flex-direction: column;
                align-items: stretch;
            }
            
            .nav-btn {
                margin: 5px 0;
            }
            
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîÑ Diagramas de Sequ√™ncia</h1>
            <p>Sistema Tutorando - Fluxos de Intera√ß√£o Detalhados</p>
        </div>
        
        <div class="nav-buttons">
            <button class="nav-btn active" onclick="showDiagram('auth')">üîê Autentica√ß√£o</button>
            <button class="nav-btn" onclick="showDiagram('register')">üìù Registro</button>
            <button class="nav-btn" onclick="showDiagram('project')">üìã Cria√ß√£o de Projeto</button>
            <button class="nav-btn" onclick="showDiagram('approval')">‚úÖ Aprova√ß√£o</button>
            <button class="nav-btn" onclick="showDiagram('search')">üîç Busca de Tutores</button>
            <button class="nav-btn" onclick="showDiagram('publication')">üìÑ Publica√ß√£o</button>
            <button class="nav-btn" onclick="showDiagram('bulk')">üì¶ Aprova√ß√£o em Massa</button>
            <button class="nav-btn" onclick="showDiagram('edit')">‚úèÔ∏è Edi√ß√£o</button>
            <button class="nav-btn" onclick="showDiagram('dashboard')">üìä Dashboard Admin</button>
            <button class="nav-btn" onclick="showDiagram('delete')">üóëÔ∏è Exclus√£o</button>
        </div>
        
        <!-- Sequ√™ncia de Autentica√ß√£o -->
        <div id="auth" class="diagram-section active">
            <h2 class="diagram-title"><span class="emoji">üîê</span>Sequ√™ncia de Autentica√ß√£o de Usu√°rio</h2>
            <div class="diagram-description">
                <p>Este diagrama mostra o fluxo completo de autentica√ß√£o de usu√°rios no sistema, incluindo valida√ß√£o de credenciais e redirecionamentos.</p>
            </div>
            <div class="mermaid-container">
                <div class="mermaid">
sequenceDiagram
    participant U as üë§ Usu√°rio
    participant B as üåê Browser
    participant WEB as üõ£Ô∏è Web Router
    participant AC as üéØ AuthController
    participant M as üõ°Ô∏è Middleware
    participant AUTH as üîê Auth Facade
    participant DB as üóÑÔ∏è Database
    participant R as ‚Ü©Ô∏è Redirect

    U->>B: Acessa p√°gina de login
    B->>WEB: GET /login
    WEB->>AC: create()
    AC->>B: view('auth.login')
    B->>U: Formul√°rio de login

    U->>B: Submete credenciais
    B->>WEB: POST /login
    WEB->>M: guest middleware
    M->>AC: store(LoginRequest)
    AC->>AUTH: attempt($credentials)
    AUTH->>DB: SELECT * FROM users WHERE email=?
    
    alt ‚úÖ Credenciais v√°lidas
        DB-->>AUTH: User data
        AUTH-->>AC: Authentication success
        AC->>AUTH: login($user)
        AC->>R: redirect()->intended('/dashboard')
        R->>B: HTTP 302 Location: /dashboard
        B->>U: Redirecionamento para dashboard
    else ‚ùå Credenciais inv√°lidas
        AUTH-->>AC: Authentication failed
        AC->>B: back()->withErrors()
        B->>U: Erro de autentica√ß√£o
    end
                </div>
            </div>
            <div class="info-box">
                <h4>üí° Pontos Importantes:</h4>
                <ul>
                    <li>Middleware guest impede acesso de usu√°rios autenticados</li>
                    <li>Sistema de redirecionamento inteligente ap√≥s login</li>
                    <li>Tratamento de erros com feedback visual</li>
                    <li>Valida√ß√£o de credenciais atrav√©s do Auth Facade</li>
                </ul>
            </div>
        </div>

        <!-- Sequ√™ncia de Registro -->
        <div id="register" class="diagram-section">
            <h2 class="diagram-title"><span class="emoji">üìù</span>Sequ√™ncia de Registro de Usu√°rio</h2>
            <div class="diagram-description">
                <p>Fluxo de cadastro de novos usu√°rios com valida√ß√£o de dados, cria√ß√£o de conta e envio de email de confirma√ß√£o.</p>
            </div>
            <div class="mermaid-container">
                <div class="mermaid">
sequenceDiagram
    participant U as üë§ Usu√°rio
    participant B as üåê Browser
    participant WEB as üõ£Ô∏è Web Router
    participant RC as üéØ RegisterController
    participant M as üõ°Ô∏è Middleware
    participant V as ‚úÖ Validator
    participant USER as üë• User Model
    participant DB as üóÑÔ∏è Database
    participant MAIL as üìß Mail System
    participant AUTH as üîê Auth Facade

    U->>B: Acessa p√°gina de registro
    B->>WEB: GET /register
    WEB->>RC: create()
    RC->>B: view('auth.register')
    B->>U: Formul√°rio de registro

    U->>B: Submete dados de registro
    B->>WEB: POST /register
    WEB->>M: guest middleware
    M->>RC: store(Request)
    RC->>V: validate($request)
    
    alt ‚úÖ Dados v√°lidos
        V-->>RC: Validation passed
        RC->>USER: create($userData)
        USER->>DB: INSERT INTO users
        DB-->>USER: User created
        USER-->>RC: $user object
        
        RC->>MAIL: event(new Registered($user))
        MAIL->>U: üìß Email de confirma√ß√£o
        
        RC->>AUTH: login($user)
        RC->>B: redirect('/dashboard')
        B->>U: Redirecionamento para dashboard
    else ‚ùå Dados inv√°lidos
        V-->>RC: Validation failed
        RC->>B: back()->withErrors()
        B->>U: Erros de valida√ß√£o
    end
                </div>
            </div>
            <div class="info-box">
                <h4>üí° Caracter√≠sticas do Registro:</h4>
                <ul>
                    <li>Valida√ß√£o completa dos dados de entrada</li>
                    <li>Auto-login ap√≥s registro bem-sucedido</li>
                    <li>Sistema de notifica√ß√£o por email</li>
                    <li>Tratamento de erros de valida√ß√£o</li>
                </ul>
            </div>
        </div>

        <!-- Sequ√™ncia de Cria√ß√£o de Projeto -->
        <div id="project" class="diagram-section">
            <h2 class="diagram-title"><span class="emoji">üìã</span>Sequ√™ncia de Cria√ß√£o de Projeto</h2>
            <div class="diagram-description">
                <p>Processo completo de cria√ß√£o de projetos, incluindo upload de arquivos, valida√ß√µes e aprova√ß√£o autom√°tica para admins.</p>
            </div>
            <div class="mermaid-container">
                <div class="mermaid">
sequenceDiagram
    participant T as üë®‚Äçüéì Tutor/Tutorando
    participant B as üåê Browser
    participant WEB as üõ£Ô∏è Web Router
    participant AM as üõ°Ô∏è Auth Middleware
    participant PC as üéØ ProjetoController
    participant V as ‚úÖ Validator
    participant PM as üìã Projeto Model
    participant FS as üìÅ File Storage
    participant DB as üóÑÔ∏è Database
    participant ADMIN as üë®‚Äçüíº Admin System

    T->>B: Acessa cria√ß√£o de projeto
    B->>WEB: GET /projetos/create
    WEB->>AM: auth middleware
    AM->>PC: create()
    PC->>B: view('projetos.create')
    B->>T: Formul√°rio de cria√ß√£o

    T->>B: Submete dados do projeto
    B->>WEB: POST /projetos
    WEB->>AM: auth middleware
    AM->>PC: store(Request)
    PC->>V: validate($request)
    
    alt ‚úÖ Dados v√°lidos
        V-->>PC: Validation passed
        PC->>PM: new Projeto()
        PC->>PM: set project data
        
        alt üë®‚Äçüíº Usu√°rio √© Admin
            PC->>PM: aprovado = true
        else üë§ Usu√°rio comum
            PC->>PM: aprovado = false
        end
        
        alt üìÑ Tem arquivo PDF
            PC->>FS: store('projetos/pdfs')
            FS-->>PC: file path
            PC->>PM: arquivo_pdf = path
        end
        
        alt üñºÔ∏è Tem imagens
            loop Para cada imagem
                PC->>FS: store('projetos/imagens')
                FS-->>PC: image path
            end
            PC->>PM: imagens = paths
        end
        
        PC->>PM: save()
        PM->>DB: INSERT INTO projetos
        DB-->>PM: Project saved
        PM-->>PC: Success
        
        alt üë§ Usu√°rio n√£o √© Admin
            PC->>ADMIN: üîî Notificar projeto pendente
        end
        
        PC->>B: redirect()->with('success')
        B->>T: ‚úÖ Confirma√ß√£o de cria√ß√£o
    else ‚ùå Dados inv√°lidos
        V-->>PC: Validation failed
        PC->>B: back()->withErrors()
        B->>T: ‚ùå Erros de valida√ß√£o
    end
                </div>
            </div>
        </div>

        <!-- Sequ√™ncia de Aprova√ß√£o -->
        <div id="approval" class="diagram-section">
            <h2 class="diagram-title"><span class="emoji">‚úÖ</span>Sequ√™ncia de Aprova√ß√£o de Projeto (Admin)</h2>
            <div class="diagram-description">
                <p>Fluxo de aprova√ß√£o de projetos pelo administrador, incluindo notifica√ß√µes e logs de auditoria.</p>
            </div>
            <div class="mermaid-container">
                <div class="mermaid">
sequenceDiagram
    participant A as üë®‚Äçüíº Admin
    participant B as üåê Browser
    participant WEB as üõ£Ô∏è Web Router
    participant AM as üõ°Ô∏è Admin Middleware
    participant APC as üéØ Admin::ProjetoController
    participant PM as üìã Projeto Model
    participant DB as üóÑÔ∏è Database
    participant MAIL as üìß Mail System
    participant CACHE as üóÑÔ∏è Cache System
    participant AL as üìù AuditLog

    A->>B: Acessa dashboard admin
    B->>WEB: GET /admin/projetos
    WEB->>AM: admin middleware
    AM->>APC: index()
    APC->>DB: SELECT projetos WHERE aprovado=false
    DB-->>APC: Projetos pendentes
    APC->>B: view with pending projects
    B->>A: Lista de projetos pendentes

    A->>B: Clica em aprovar projeto
    B->>WEB: PATCH /admin/projetos/{id}/approve
    WEB->>AM: admin middleware
    AM->>APC: approve(Projeto)
    APC->>PM: update(['aprovado' => true])
    PM->>DB: UPDATE projetos SET aprovado=1
    DB-->>PM: Success
    PM-->>APC: Project approved
    
    APC->>MAIL: sendNotificationEmail($project, 'approve')
    MAIL->>APC: üìß Email enviado ao tutor
    
    APC->>AL: logAuditAction('approve')
    AL->>DB: INSERT INTO audit_logs
    
    APC->>CACHE: forget('projeto-'.$id)
    APC->>CACHE: forget('admin-dashboard-stats')
    
    APC->>B: redirect()->with('success')
    B->>A: ‚úÖ Confirma√ß√£o de aprova√ß√£o
                </div>
            </div>
        </div>

        <!-- Sequ√™ncia de Busca -->
        <div id="search" class="diagram-section">
            <h2 class="diagram-title"><span class="emoji">üîç</span>Sequ√™ncia de Busca de Tutores</h2>
            <div class="diagram-description">
                <p>Sistema de busca integrado com cache para encontrar tutores, projetos e publica√ß√µes de forma eficiente.</p>
            </div>
            <div class="mermaid-container">
                <div class="mermaid">
sequenceDiagram
    participant TU as üë®‚Äçüéì Tutorando
    participant B as üåê Browser
    participant WEB as üõ£Ô∏è Web Router
    participant AM as üõ°Ô∏è Auth Middleware
    participant SC as üéØ SearchController
    participant UM as üë• User Model
    participant PM as üìã Projeto Model
    participant PUM as üìÑ Publicacao Model
    participant DB as üóÑÔ∏è Database
    participant CACHE as üóÑÔ∏è Cache

    TU->>B: Acessa busca de tutores
    B->>WEB: GET /tutores
    WEB->>AM: auth middleware
    AM->>B: Formul√°rio de busca
    B->>TU: Interface de busca

    TU->>B: Submete crit√©rios de busca
    B->>WEB: GET /search?query=...
    WEB->>AM: auth middleware
    AM->>SC: search(Request)
    
    SC->>CACHE: remember('search-' + query)
    
    alt üéØ Cache exists
        CACHE-->>SC: Cached results
    else üîÑ Cache miss
        SC->>PM: WHERE titulo LIKE %query%
        PM->>DB: SELECT projetos
        DB-->>PM: Project results
        PM-->>SC: Projects found
        
        SC->>PUM: WHERE titulo LIKE %query%
        PUM->>DB: SELECT publicacoes
        DB-->>PUM: Publication results
        PUM-->>SC: Publications found
        
        SC->>UM: WHERE name LIKE %query% AND role='tutor'
        UM->>DB: SELECT users
        DB-->>UM: Tutor results
        UM-->>SC: Tutors found
        
        SC->>CACHE: store results
    end
    
    SC->>B: view('search.results')
    B->>TU: Resultados da busca
                </div>
            </div>
        </div>

        <!-- Continuar com os outros diagramas... -->
        <div id="publication" class="diagram-section">
            <h2 class="diagram-title"><span class="emoji">üìÑ</span>Sequ√™ncia de Publica√ß√£o de Conte√∫do</h2>
            <div class="diagram-description">
                <p>Processo de cria√ß√£o de publica√ß√µes com valida√ß√£o de arquivos e seguran√ßa.</p>
            </div>
            <div class="mermaid-container">
                <div class="mermaid">
sequenceDiagram
    participant T as üë®‚Äçüè´ Tutor
    participant B as üåê Browser
    participant WEB as üõ£Ô∏è Web Router
    participant TM as üõ°Ô∏è Tutor Middleware
    participant PC as üéØ PublicacaoController
    participant V as ‚úÖ Validator
    participant FS as üîí FileValidationService
    participant ST as üìÅ Storage
    participant PU as üìÑ Publicacao Model
    participant DB as üóÑÔ∏è Database

    T->>B: Acessa cria√ß√£o de publica√ß√£o
    B->>WEB: GET /publicacoes/create
    WEB->>TM: tutor middleware
    TM->>PC: create()
    PC->>B: view('publicacoes.create')
    B->>T: Formul√°rio de publica√ß√£o

    T->>B: Submete publica√ß√£o
    B->>WEB: POST /publicacoes
    WEB->>TM: tutor middleware
    TM->>PC: store(Request)
    PC->>V: validate($request)
    
    alt ‚úÖ Dados v√°lidos
        V-->>PC: Validation passed
        PC->>PU: new Publicacao()
        
        alt üìé Tem arquivo
            PC->>FS: validate($file)
            FS->>FS: check file type/size
            alt ‚úÖ Arquivo v√°lido
                FS-->>PC: File valid
                PC->>FS: storeSecurely($file)
                FS->>ST: store in secure location
                ST-->>FS: file path
                FS-->>PC: file info
                PC->>PU: set file data
            else ‚ùå Arquivo inv√°lido
                FS-->>PC: Validation error
                PC->>B: back()->withErrors()
                B->>T: ‚ùå Erro de arquivo
            end
        end
        
        PC->>PU: save()
        PU->>DB: INSERT INTO publicacoes
        DB-->>PU: Publication saved
        
        PC->>B: redirect()->with('success')
        B->>T: ‚úÖ Confirma√ß√£o de cria√ß√£o
    else ‚ùå Dados inv√°lidos
        V-->>PC: Validation failed
        PC->>B: back()->withErrors()
        B->>T: ‚ùå Erros de valida√ß√£o
    end
                </div>
            </div>
        </div>

        <!-- Aprova√ß√£o em Massa -->
        <div id="bulk" class="diagram-section">
            <h2 class="diagram-title"><span class="emoji">üì¶</span>Sequ√™ncia de Aprova√ß√£o em Massa</h2>
            <div class="diagram-description">
                <p>Sistema de aprova√ß√£o de m√∫ltiplos projetos simultaneamente para otimizar o trabalho administrativo.</p>
            </div>
            <div class="mermaid-container">
                <div class="mermaid">
sequenceDiagram
    participant A as üë®‚Äçüíº Admin
    participant B as üåê Browser
    participant WEB as üõ£Ô∏è Web Router
    participant AM as üõ°Ô∏è Admin Middleware
    participant APC as üéØ Admin::ProjetoController
    participant PM as üìã Projeto Model
    participant DB as üóÑÔ∏è Database
    participant MAIL as üìß Mail System
    participant AL as üìù AuditLog

    A->>B: Seleciona m√∫ltiplos projetos
    B->>A: ‚úÖ Checkboxes selecionados
    A->>B: Clica "Aprovar em Massa"
    B->>WEB: POST /admin/projetos/bulk-action
    WEB->>AM: admin middleware
    AM->>APC: bulkAction(Request)
    APC->>APC: validate(['action', 'projeto_ids'])
    
    APC->>DB: SELECT projetos WHERE id IN (...)
    DB-->>APC: Selected projects
    
    loop üîÑ Para cada projeto
        APC->>PM: update(['aprovado' => true])
        PM->>DB: UPDATE projetos
        DB-->>PM: Success
        
        APC->>AL: logAuditAction('bulk_approve')
        AL->>DB: INSERT INTO audit_logs
        
        APC->>MAIL: sendNotificationEmail($projeto, 'approve')
        MAIL->>APC: üìß Email sent
    end
    
    APC->>B: redirect()->with('success', 'X projetos aprovados')
    B->>A: ‚úÖ Confirma√ß√£o de aprova√ß√£o em massa
                </div>
            </div>
        </div>

        <!-- Edi√ß√£o -->
        <div id="edit" class="diagram-section">
            <h2 class="diagram-title"><span class="emoji">‚úèÔ∏è</span>Sequ√™ncia de Edi√ß√£o de Projeto</h2>
            <div class="diagram-description">
                <p>Processo de edi√ß√£o de projetos com verifica√ß√£o de autoriza√ß√£o e gerenciamento de arquivos.</p>
            </div>
            <div class="mermaid-container">
                <div class="mermaid">
sequenceDiagram
    participant U as üë§ Usu√°rio
    participant B as üåê Browser
    participant WEB as üõ£Ô∏è Web Router
    participant AM as üõ°Ô∏è Auth Middleware
    participant PC as üéØ ProjetoController
    participant V as ‚úÖ Validator
    participant PM as üìã Projeto Model
    participant FS as üìÅ File Storage
    participant DB as üóÑÔ∏è Database

    U->>B: Acessa edi√ß√£o de projeto
    B->>WEB: GET /projetos/{id}/edit
    WEB->>AM: auth middleware
    AM->>PC: edit(Projeto)
    PC->>PC: check ownership/admin
    
    alt ‚úÖ Autorizado
        PC->>B: view('projetos.edit', $projeto)
        B->>U: Formul√°rio de edi√ß√£o preenchido
        
        U->>B: Submete altera√ß√µes
        B->>WEB: PUT /projetos/{id}
        WEB->>AM: auth middleware
        AM->>PC: update(Request, Projeto)
        PC->>V: validate($request)
        
        alt ‚úÖ Dados v√°lidos
            V-->>PC: Validation passed
            
            alt üóëÔ∏è Remove arquivos
                PC->>FS: delete(old files)
            end
            
            alt üì§ Upload novos arquivos
                PC->>FS: store(new files)
                FS-->>PC: new file paths
            end
            
            PC->>PM: save()
            PM->>DB: UPDATE projetos
            DB-->>PM: Success
            
            PC->>B: redirect()->with('success')
            B->>U: ‚úÖ Confirma√ß√£o de atualiza√ß√£o
        else ‚ùå Dados inv√°lidos
            V-->>PC: Validation failed
            PC->>B: back()->withErrors()
            B->>U: ‚ùå Erros de valida√ß√£o
        end
    else ‚ùå N√£o autorizado
        PC->>B: abort(403)
        B->>U: ‚ùå Erro de autoriza√ß√£o
    end
                </div>
            </div>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="diagram-section">
            <h2 class="diagram-title"><span class="emoji">üìä</span>Sequ√™ncia de Dashboard Admin</h2>
            <div class="diagram-description">
                <p>Carregamento otimizado do dashboard administrativo com estat√≠sticas em cache.</p>
            </div>
            <div class="mermaid-container">
                <div class="mermaid">
sequenceDiagram
    participant A as üë®‚Äçüíº Admin
    participant B as üåê Browser
    participant WEB as üõ£Ô∏è Web Router
    participant AM as üõ°Ô∏è Admin Middleware
    participant DC as üéØ DashboardController
    participant CACHE as üóÑÔ∏è Cache Service
    participant DB as üóÑÔ∏è Database

    A->>B: Acessa dashboard admin
    B->>WEB: GET /admin/dashboard
    WEB->>AM: admin middleware
    AM->>DC: index()
    DC->>CACHE: getDashboardStats()
    
    alt üéØ Cache exists
        CACHE-->>DC: Cached statistics
    else üîÑ Cache miss
        CACHE->>DB: Count users, projects, publications
        DB-->>CACHE: Statistics data
        CACHE->>CACHE: store('admin-dashboard-stats', $stats, 300s)
    end
    
    DC->>B: view('admin.dashboard', $stats)
    B->>A: üìä Dashboard com estat√≠sticas
                </div>
            </div>
        </div>

        <!-- Exclus√£o -->
        <div id="delete" class="diagram-section">
            <h2 class="diagram-title"><span class="emoji">üóëÔ∏è</span>Sequ√™ncia de Exclus√£o de Conte√∫do</h2>
            <div class="diagram-description">
                <p>Processo seguro de exclus√£o de projetos com limpeza de arquivos e logs de auditoria.</p>
            </div>
            <div class="mermaid-container">
                <div class="mermaid">
sequenceDiagram
    participant U as üë§ Usu√°rio
    participant B as üåê Browser
    participant WEB as üõ£Ô∏è Web Router
    participant AM as üõ°Ô∏è Auth Middleware
    participant PC as üéØ ProjetoController
    participant PM as üìã Projeto Model
    participant FS as üìÅ File Storage
    participant DB as üóÑÔ∏è Database
    participant AL as üìù AuditLog

    U->>B: Clica em excluir projeto
    B->>U: ‚ö†Ô∏è Modal de confirma√ß√£o
    U->>B: Confirma exclus√£o
    B->>WEB: DELETE /projetos/{id}
    WEB->>AM: auth middleware
    AM->>PC: destroy(Projeto)
    PC->>PC: check ownership/admin
    
    alt ‚úÖ Autorizado
        alt üìÑ Tem arquivos
            PC->>FS: delete(all project files)
        end
        
        PC->>AL: logAuditAction('delete')
        AL->>DB: INSERT INTO audit_logs
        
        PC->>PM: delete()
        PM->>DB: DELETE FROM projetos WHERE id=?
        DB-->>PM: Success
        
        PC->>B: redirect()->with('success')
        B->>U: ‚úÖ Confirma√ß√£o de exclus√£o
    else ‚ùå N√£o autorizado
        PC->>B: abort(403)
        B->>U: ‚ùå Erro de autoriza√ß√£o
    end
                </div>
            </div>
            <div class="info-box">
                <h4>üîí Medidas de Seguran√ßa:</h4>
                <ul>
                    <li>Verifica√ß√£o de autoriza√ß√£o antes da exclus√£o</li>
                    <li>Limpeza completa de arquivos associados</li>
                    <li>Log de auditoria para rastreabilidade</li>
                    <li>Modal de confirma√ß√£o para prevenir exclus√µes acidentais</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Inicializar Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            sequence: {
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35,
                mirrorActors: true,
                bottomMarginAdj: 1,
                useMaxWidth: true,
                rightAngles: false,
                showSequenceNumbers: false
            }
        });

        // Fun√ß√£o para mostrar diagrama espec√≠fico
        function showDiagram(diagramId) {
            // Ocultar todos os diagramas
            const sections = document.querySelectorAll('.diagram-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });

            // Remover classe active de todos os bot√µes
            const buttons = document.querySelectorAll('.nav-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
            });

            // Mostrar diagrama selecionado
            document.getElementById(diagramId).classList.add('active');

            // Ativar bot√£o selecionado
            event.target.classList.add('active');
        }

        // Reprocessar diagramas quando mudamos de se√ß√£o
        function reprocessDiagrams() {
            mermaid.init(undefined, document.querySelectorAll('.mermaid'));
        }

        // Aguardar carregamento completo
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(reprocessDiagrams, 1000);
        });
    </script>
</body>
</html>
